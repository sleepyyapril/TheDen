# SPDX-FileCopyrightText: 2025 ASaltySeabass
# SPDX-FileCopyrightText: 2025 Jakumba
# SPDX-FileCopyrightText: 2025 Shaman
#
# SPDX-License-Identifier: AGPL-3.0-or-later

- type: entity
  name: shot gun bolt
  id: ShotgunLaserPellet
  parent: BulletLaser
  categories: [ HideSpawnMenu ]
  components:
  - type: Projectile
    impactEffect: BulletImpactEffectOrangeDisabler
    damage:
      types:
        Heat: 15
    soundHit:
      collection: WeakHit
    forceSound: true

- type: entity
  name: narrow laser barrage
  id: WardenEnergyShotgunLethalMode
  parent: ShotgunLaserPellet
  categories: [ HideSpawnMenu ]
  components:
  - type: ProjectileSpread
    proto: ShotgunLaserPellet
    count: 5 # 75 heat damage if you hit all your shots
    spread: 13

- type: entity
  name: disabler laser barrage
  id: WardenEnergyShotgunDisablerMode
  parent: BulletDisablerSmg
  categories: [ HideSpawnMenu ]
  components:
  - type: ProjectileSpread
    proto: BulletDisablerSmg
    count: 5 # 2 shot stamina crit if you can land all the shots
    spread: 13

# Mantis projectiles start
# Muzzle flashes
- type: entity
  parent: MuzzleFlashEffect
  id: MuzzleFlashEffectMantisCapgun
  categories: [ HideSpawnMenu ]
  components:
  - type: TimedDespawn
    lifetime: 0.4
  - type: Sprite
    drawdepth: Effects
    offset: 0.1, 0
    layers:
    - sprite: _DEN/Objects/Weapons/Guns/Projectiles/mantis.rsi
      state: muzzle_capgun
      map: ["enum.EffectLayers.Unshaded"]
      shader: unshaded
  - type: PointLight
    enabled: true
    radius: 2
    energy: 3
    color: "#ffb869"

- type: entity
  parent: MuzzleFlashEffect
  id: MuzzleFlashEffectMantisCrypto
  categories: [ HideSpawnMenu ]
  components:
  - type: TimedDespawn
    lifetime: 0.4
  - type: Sprite
    drawdepth: Effects
    offset: 0.1, 0
    layers:
    - sprite: _DEN/Objects/Weapons/Guns/Projectiles/mantis.rsi
      state: muzzle_crypto
      map: ["enum.EffectLayers.Unshaded"]
      shader: unshaded
  - type: PointLight
    enabled: true
    radius: 2
    energy: 3
    color: "#6279f9"

- type: entity
  parent: MuzzleFlashEffect
  id: MuzzleFlashEffectMantisHoly
  categories: [ HideSpawnMenu ]
  components:
  - type: TimedDespawn
    lifetime: 0.4
  - type: Sprite
    drawdepth: Effects
    offset: 0.1, 0
    layers:
    - sprite: _DEN/Objects/Weapons/Guns/Projectiles/mantis.rsi
      state: muzzle_holy
      map: ["enum.EffectLayers.Unshaded"]
      shader: unshaded
  - type: PointLight
    enabled: true
    radius: 2
    energy: 3
    color: "#88b0d0"

- type: entity
  parent: MuzzleFlashEffect
  id: MuzzleFlashEffectMantisLethal
  categories: [ HideSpawnMenu ]
  components:
  - type: TimedDespawn
    lifetime: 0.4
  - type: Sprite
    drawdepth: Effects
    offset: 0.1, 0
    layers:
    - sprite: _DEN/Objects/Weapons/Guns/Projectiles/mantis.rsi
      state: muzzle_lethal
      map: ["enum.EffectLayers.Unshaded"]
      shader: unshaded
  - type: PointLight
    enabled: true
    radius: 2
    energy: 3
    color: "#44fbf7"

# Capgun bullets
- type: entity
  parent: BaseBullet
  id: BulletMantisCapgun
  categories: [ HideSpawnMenu ]
  components:
  - type: Sprite
    sprite: _DEN/Objects/Weapons/Guns/Projectiles/mantis.rsi
    layers:
    - state: bullet_capgun
  - type: Ammo
    muzzleFlash: MuzzleFlashEffectMantisCapgun # Big fiery flash
  - type: Projectile
    impactEffect: BulletImpactEffectMantisCapgun # Silly little sparkle
    damage:
      types:
        Piercing: 0
    soundHit:
      path: /Audio/_DEN/Weapons/Guns/Hits/bwomp.ogg
      params:
        variation: 0.05

- type: entity
  parent: BulletMantisCapgun
  id: BulletMantisCapgunSpread
  categories: [ HideSpawnMenu ]
  components:
  - type: ProjectileSpread
    proto: BulletMantisCapgun
    count: 6
    spread: 20

# Pistol bullets, the rest are parented to these with damage/transfer amounts adjusted
# Initial piercing/holy damage values chosen by direction, may need work
- type: entity
  parent: BaseBullet
  id: BaseBulletMantis
  categories: [ HideSpawnMenu ]
  abstract: true
  components:
  - type: Fixtures
    fixtures:
      projectile:
        shape:
          !type:PhysShapeAabb
          bounds: "-0.1,-0.1,0.1,0.1"
        hard: false
        mask:
        - Impassable
        - BulletImpassable
        - Opaque
      fly-by: &flybyfixture
        shape: !type:PhysShapeCircle
          radius: 1.5
        layer:
        - Impassable
        - MidImpassable
        - HighImpassable
        - LowImpassable
        - Opaque
        hard: False

- type: entity
  parent: BaseBulletMantis
  id: BulletMantisCrypto
  categories: [ HideSpawnMenu ]
  components:
  - type: Sprite
    sprite: _DEN/Objects/Weapons/Guns/Projectiles/mantis.rsi
    layers:
    - state: bullet_crypto
      shader: unshaded
  - type: PointLight
    enabled: true
    radius: 1.75
    energy: 1.75
    color: "#6279f9"
  - type: Ammo
    muzzleFlash: MuzzleFlashEffectMantisCrypto
  - type: Projectile
    impactEffect: BulletImpactEffectMantisCrypto
    damage:
      types:
        Piercing: 0
    soundHit:
      path: /Audio/_DEN/Weapons/Guns/Hits/hyposhot.ogg
      params:
        variation: 0.05
  - type: ChemicalAmmo
  - type: SolutionContainerManager
    solutions:
      ammo:
        reagents:
        - ReagentId: Cryptobiolin
          Quantity: 5
  - type: SolutionInjectOnProjectileHit
    solution: ammo
    transferAmount: 5 # 5u of crypto disables psionics for 1m40s, and a full magazine of any mantis gun will disable psionics for 20m

- type: entity
  parent: BaseBulletMantis
  id: BulletMantisHoly
  categories: [ HideSpawnMenu ]
  components:
  - type: Sprite
    sprite: _DEN/Objects/Weapons/Guns/Projectiles/mantis.rsi
    layers:
    - state: bullet_holy
      shader: unshaded
  - type: PointLight
    enabled: true
    radius: 1.75
    energy: 1.75
    color: "#88b0d0"
  - type: Ammo
    muzzleFlash: MuzzleFlashEffectMantisHoly
  - type: Projectile
    impactEffect: BulletImpactEffectMantisHoly
    damage:
      types:
        Holy: 10
    soundHit:
      path: /Audio/_DEN/Weapons/Guns/Hits/burnshot.ogg
      params:
        variation: 0.05

- type: entity
  parent: BaseBulletMantis
  id: BulletMantisLethal
  categories: [ HideSpawnMenu ]
  components:
  - type: Sprite
    sprite: _DEN/Objects/Weapons/Guns/Projectiles/mantis.rsi
    layers:
    - state: bullet_lethal
      shader: unshaded
  - type: PointLight
    enabled: true
    radius: 1.75
    energy: 1.75
    color: "#44fbf7"
  - type: Ammo
    muzzleFlash: MuzzleFlashEffectMantisLethal
  - type: Projectile
    impactEffect: BulletImpactEffectMantisLethal
    damage:
      types:
        Piercing: 15
    soundHit:
      path: /Audio/Weapons/Guns/Hits/bullet_hit.ogg
      params:
        variation: 0.05

# Revolver bullets
- type: entity
  parent: BulletMantisCrypto
  id: BulletMantisCryptoRevolver
  categories: [ HideSpawnMenu ]
  components:
  - type: SolutionContainerManager
    solutions:
      ammo:
        reagents:
        - ReagentId: Cryptobiolin
          Quantity: 10
  - type: SolutionInjectOnProjectileHit
    solution: ammo
    transferAmount: 10 # 10u of crypto disables psionics for 3m20s, and a full magazine of any mantis gun will disable psionics for 20m

- type: entity
  parent: BulletMantisHoly
  id: BulletMantisHolyRevolver
  categories: [ HideSpawnMenu ]
  components:
  - type: Projectile
    damage:
      types:
        Holy: 30

- type: entity
  parent: BulletMantisLethal
  id: BulletMantisLethalRevolver
  categories: [ HideSpawnMenu ]
  components:
  - type: Projectile
    damage:
      types:
        Piercing: 36

# Shotgun bullets
- type: entity
  parent: BulletMantisCrypto
  id: BulletMantisCryptoShotgun
  categories: [ HideSpawnMenu ]
  components:
  - type: SolutionContainerManager
    solutions:
      ammo:
        reagents:
        - ReagentId: Cryptobiolin
          Quantity: 2
  - type: SolutionInjectOnProjectileHit
    solution: ammo
    transferAmount: 2 # 2u of crypto disables psionics for 40s, and a full magazine of any mantis gun will disable psionics for 20m

- type: entity
  parent: BulletMantisCryptoShotgun
  id: BulletMantisCryptoSpread
  categories: [ HideSpawnMenu ]
  components:
  - type: ProjectileSpread
    proto: BulletMantisCryptoShotgun
    count: 6 # 12u of crypto disables psionics for 4m, and a full magazine of any mantis gun will disable psionics for 20m
    spread: 20

- type: entity
  parent: BulletMantisHoly
  id: BulletMantisHolyShotgun
  categories: [ HideSpawnMenu ]
  components:
  - type: Projectile
    damage:
      types:
        Holy: 8

- type: entity
  parent: BulletMantisHolyShotgun
  id: BulletMantisHolySpread
  categories: [ HideSpawnMenu ]
  components:
  - type: ProjectileSpread
    proto: BulletMantisHolyShotgun
    count: 6
    spread: 20

- type: entity
  parent: BulletMantisLethal
  id: BulletMantisLethalShotgun
  categories: [ HideSpawnMenu ]
  components:
  - type: Projectile
    damage:
      types:
        Piercing: 9

- type: entity
  parent: BulletMantisLethalShotgun
  id: BulletMantisLethalSpread
  categories: [ HideSpawnMenu ]
  components:
  - type: ProjectileSpread
    proto: BulletMantisLethalShotgun
    count: 6
    spread: 20

# Submachine gun bullets
- type: entity
  parent: BulletMantisCrypto
  id: BulletMantisCryptoSubMachineGun
  categories: [ HideSpawnMenu ]
  components:
  - type: SolutionContainerManager
    solutions:
      ammo:
        reagents:
        - ReagentId: Cryptobiolin
          Quantity: 2.5
  - type: SolutionInjectOnProjectileHit
    solution: ammo
    transferAmount: 2.5 # 2.5u of crypto disables psionics for 50s, and a full magazine of any mantis gun will disable psionics for 20m

- type: entity
  parent: BulletMantisHoly
  id: BulletMantisHolySubMachineGun
  categories: [ HideSpawnMenu ]
  components:
  - type: Projectile
    damage:
      types:
        Holy: 8

- type: entity
  parent: BulletMantisLethal
  id: BulletMantisLethalSubMachineGun
  categories: [ HideSpawnMenu ]
  components:
  - type: Projectile
    damage:
      types:
        Piercing: 12
# Mantis projectiles end
