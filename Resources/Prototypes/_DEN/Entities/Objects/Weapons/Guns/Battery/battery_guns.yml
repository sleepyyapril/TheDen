# SPDX-FileCopyrightText: 2025 ASaltySeabass
# SPDX-FileCopyrightText: 2025 Shaman
#
# SPDX-License-Identifier: AGPL-3.0-or-later

- type: entity
  name: pulse PDW
  parent: [BaseWeaponBattery, BaseGunWieldable, BaseCentcommBlueshieldContraband]
  id: WeaponPulsePDW
  description: A compact pulse weapon issued to Blueshield Officers for the rapid neutralization of close-range threats.
  components:
  - type: Sprite
    sprite: _DEN/Objects/Weapons/Guns/Battery/pulse_pdw.rsi
    layers:
    - state: base
      map: ["enum.GunVisualLayers.Base"]
    - state: mag-unshaded-4
      map: ["enum.GunVisualLayers.MagUnshaded"]
      shader: unshaded
  - type: Item
    size: Small
    shape:
    - 0,0,1,1
  - type: MagazineVisuals
    magState: mag
    steps: 5
    zeroVisible: true
  - type: Clothing
    quickEquip: false
    slots:
    - Belt
    - suitStorage
    - Back
    sprite: _DEN/Objects/Weapons/Guns/Battery/pulse_pdw.rsi
  - type: GunWieldBonus
    minAngle: -19
    maxAngle: -16
  - type: Gun
    minAngle: 21
    maxAngle: 32
    angleIncrease: 10 #Starts off very accurate, but quickly loses that accuracy after only a couple of shots.
    angleDecay: 10
    selectedMode: SemiAuto
    fireRate: 3
    availableModes:
      - SemiAuto
      - FullAuto
    soundGunshot:
      path: /Audio/Weapons/Guns/Gunshots/laser_cannon.ogg
  - type: HitscanBatteryAmmoProvider
    proto: PulsePDW
    fireCost: 200
  - type: Battery
    maxCharge: 5005
    startingCharge: 5005
  - type: Tag
    tags:
    - PulsePDW
    - Sidearm
  - type: BatterySelfRecharger # 50 seconds to fully recharge, but it does not do so if it has been fired in the last 10 seconds. 60 seconds total when empty.
    autoRecharge: true
    autoRechargeRate: 100
    autoRechargePause: true
    autoRechargePauseTime: 10


# Mantis guns start
- type: entity
  parent: [BaseWeaponPowerCell, BaseMantisContraband]
  id: BaseMantisRanged # Lorewise, they use altered and contained anomaly cores to generate physical ammo
  abstract: true # But codewise, they're just battery guns that look and sound like they're shooting ballistics
  components:
  - type: Sprite
    layers:
    - state: base
      map: ["enum.GunVisualLayers.Base"]
    - state: mag-0
      map: ["enum.GunVisualLayers.Mag"]
  - type: Item
    size: Normal # Defaults to a 2x2 square
  - type: Clothing
    quickEquip: false
    slots:
    - suitStorage
  - type: Gun
    fireOnDropChance: 0.1
    soundEmpty:
      path: /Audio/_DV/Weapons/Guns/Empty/dry_fire.ogg
      params:
        volume: -5
        variation: 0.05
  - type: MagazineVisuals
    magState: mag
    zeroVisible: true
  - type: ItemSlots
    slots:
      gun_magazine:
        name: Magazine
        startingItem: null
        whitelist:
          tags:
          - MantisCaster
  - type: Execution
  - type: MeleeWeapon
    attackRate: 1.2
    damage:
      types:
        Blunt: 7.5
    wideAnimationRotation: 90
    soundHit:
      collection: MetalThud
  - type: ThrowingAngle
    angle: -90
    angularVelocity: true
  - type: Tag
    tags:
    - MantisBeltStorable
  - type: GuideHelp
    guides: [ MantisGuide ]

- type: entity
  parent: BaseMantisRanged
  id: MantisRangedPistol
  name: OCC-P12 "Kalliste"
  description: "A sleek mantis sidearm favored for its balance and effortless precision. It uses specialized magazines called \"casters,\" each containing an anomaly core that continually forms its own bullets. Issued with both banishing and silencing casters for confronting supernatural threats and rogue psions. Designed for the Outer Chamber Crucible by special commission."
  components:
  - type: Sprite
    sprite: _DEN/Objects/Weapons/Guns/Battery/Mantis/mantis-pistol.rsi
  - type: Item
    sprite: _DEN/Objects/Weapons/Guns/Battery/Mantis/mantis-pistol.rsi
    size: Small
    shape:
    - 0,0,1,0
    - 0,1,0,1
  - type: Clothing
    sprite: _DEN/Objects/Weapons/Guns/Battery/Mantis/mantis-pistol.rsi
    slots:
    - Belt
    - suitStorage
  - type: Gun
    fireRate: 5
    soundGunshot:
      path: /Audio/Weapons/Guns/Gunshots/pistol.ogg
      params:
        volume: -1
  - type: MagazineVisuals
    steps: 13
  - type: ItemSlots
    slots:
      gun_magazine:
        name: Magazine
        startingItem: MantisCasterPistolHoly
        insertSound: /Audio/Weapons/Guns/MagIn/pistol_magin.ogg
        ejectSound: /Audio/Weapons/Guns/MagOut/pistol_magout.ogg
        whitelist:
          tags:
          - MantisCasterPistol
  - type: Tag
    tags:
    - Sidearm
    - MantisBeltStorable

- type: entity
  parent: BaseMantisRanged
  id: MantisRangedRevolver
  name: OCC-P06 "Charon"
  description: "A gilded mantis revolver engineered for measured control and heavy, deliberate impact. It uses specialized cylinders called \"casters,\" each containing an anomaly core that continually forms its own bullets. Issued with both banishing and silencing casters for confronting supernatural threats and rogue psions. Designed for the Outer Chamber Crucible by special commission."
  components:
  - type: Sprite
    sprite: _DEN/Objects/Weapons/Guns/Battery/Mantis/mantis-revolver.rsi
  - type: Item
    sprite: _DEN/Objects/Weapons/Guns/Battery/Mantis/mantis-revolver.rsi
    size: Small
    shape:
    - 0,0,1,0
    - 0,1,0,1
  - type: Clothing
    sprite: _DEN/Objects/Weapons/Guns/Battery/Mantis/mantis-revolver.rsi
    slots:
    - Belt
    - suitStorage
  - type: Gun
    fireRate: 2
    soundGunshot:
      path: /Audio/Weapons/Guns/Gunshots/revolver.ogg
      params:
        volume: -1
  - type: MagazineVisuals
    steps: 7
  - type: ItemSlots
    slots:
      gun_magazine:
        name: Magazine
        startingItem: MantisCasterRevolverHoly
        insertSound: /Audio/Weapons/Guns/Misc/revolver_spin.ogg
        ejectSound: /Audio/Weapons/Guns/MagOut/ltrifle_magout.ogg
        whitelist:
          tags:
          - MantisCasterRevolver
  - type: Tag
    tags:
    - Sidearm
    - MantisBeltStorable

- type: entity
  parent: BaseMantisRanged
  id: MantisRangedShotgun
  name: OCC-S05 "Empusa"
  description: "A vicious sawn-off mantis shotgun designed to dominate close-range encounters. It uses specialized cylinders called \"casters,\" each containing an anomaly core that continually forms its own pellets. Issued with both banishing and silencing casters for confronting supernatural threats and rogue psions. Designed for the Outer Chamber Crucible by special commission."
  components:
  - type: Sprite
    sprite: _DEN/Objects/Weapons/Guns/Battery/Mantis/mantis-shotgun.rsi
  - type: Item
    sprite: _DEN/Objects/Weapons/Guns/Battery/Mantis/mantis-shotgun-inhands-64x.rsi
    size: Normal
    shape:
    - 0,0,2,1 # 3x2 rectangle
  - type: Clothing
    sprite: _DEN/Objects/Weapons/Guns/Battery/Mantis/mantis-shotgun.rsi
    slots:
    - Back
    - suitStorage
  - type: Gun
    fireRate: 2
    soundGunshot:
      path: /Audio/Weapons/Guns/Gunshots/shotgun.ogg
      params:
        volume: -1
  - type: MagazineVisuals
    steps: 6
  - type: ItemSlots
    slots:
      gun_magazine:
        name: Magazine
        startingItem: MantisCasterShotgunHoly
        insertSound: /Audio/Weapons/Guns/Misc/revolver_spin.ogg
        ejectSound: /Audio/Weapons/Guns/MagOut/sfrifle_magout.ogg
        whitelist:
          tags:
          - MantisCasterShotgun
  - type: MeleeWeapon
    attackRate: 1.3333
    damage:
      types:
        Blunt: 9
  - type: Tag
    tags:
    - MantisBeltStorable

- type: entity
  parent: BaseMantisRanged
  id: MantisRangedSubMachineGun
  name: OCC-A24 "Strix"
  description: "A compact, fast-cycling mantis submachine gun built for relentless fire in tight spaces. It uses specialized magazines called \"casters,\" each containing an anomaly core that continually forms its own bullets. Issued with both banishing and silencing casters for confronting supernatural threats and rogue psions. Designed for the Outer Chamber Crucible by special commission."
  components:
  - type: Sprite
    sprite: _DEN/Objects/Weapons/Guns/Battery/Mantis/mantis-submachinegun.rsi
  - type: Item
    sprite: _DEN/Objects/Weapons/Guns/Battery/Mantis/mantis-submachinegun.rsi
    size: Normal
    shape:
    - 0,0,2,1 # 3x2 rectangle
  - type: Clothing
    sprite: _DEN/Objects/Weapons/Guns/Battery/Mantis/mantis-submachinegun.rsi
    slots:
    - Back
    - suitStorage
  - type: Gun
    fireRate: 8
    burstFireRate: 8
    minAngle: 6
    maxAngle: 18
    angleIncrease: 10
    angleDecay: 10
    selectedMode: FullAuto
    availableModes:
    - FullAuto
    soundGunshot:
      path: /Audio/Weapons/Guns/Gunshots/smg.ogg
      params:
        volume: -1
  - type: MagazineVisuals
    steps: 37
  - type: ItemSlots
    slots:
      gun_magazine:
        name: Magazine
        startingItem: MantisCasterSubMachineGunHoly
        insertSound: /Audio/Weapons/Guns/MagIn/smg_magin.ogg
        ejectSound: /Audio/Weapons/Guns/MagOut/smg_magout.ogg
        whitelist:
          tags:
          - MantisCasterSubMachineGun
  - type: MeleeWeapon
    attackRate: 1.3333
    damage:
      types:
        Blunt: 9
  - type: Tag
    tags:
    - MantisBeltStorable
# Mantis guns end
